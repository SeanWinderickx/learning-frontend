<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Snake Souls</title>
</head>

<div id="score">0</div>
<h2>Click play to start game </h2>
<select name="colors" id="colors">
    <option value="green">green</option>
    <option value="red">red</option>
    <option value="blue">blue</option>
</select>
<br>
<br>
<button id="button">play</button>
<canvas id="gameCanvas" width="300" height="300"></canvas>

<style>
    h2 {
        text-align: center;
    }

    #colors,
    button {
        width: 75px;
        margin-left: 46%;
        text-align: center;
    }


    #gameCanvas {
        position: absolute;
        top: 65%;
        left: 50%;
        transform: translate(-50%, -50%);
    }

    #score {
        text-align: center;
        font-size: 100px;
    }
</style>

</body>

<script>
    const speed = 100;
    //start game on play button
    let playBtn = document.getElementById("button");
    playBtn.addEventListener("click", main);
    //
    const canvas_Border_Clr = "black";
    const canvas_BG_Clr = "white";
    //default snake colors
    let snake_Clr;
    let snake_Border_Clr = "white";
    //more colors
    const food_Clr = "red";
    const food_Border_Clr = "darkred";
    let snake = [{
            x: 150,
            y: 150
        },
        {
            x: 140,
            y: 150
        },
        {
            x: 130,
            y: 150
        },
        {
            x: 120,
            y: 150
        },
        {
            x: 110,
            y: 150
        }
    ]
    let score = 0;
    // true=changing direction
    let changingDirection = false;

    // Food coordinates
    let foodX;
    let foodY;

    //velocity
    let dx = 10;
    let dy = 0;

    // Get the canvas element
    const gameCanvas = document.getElementById("gameCanvas");
    //2d drawing context
    const ctx = gameCanvas.getContext("2d");

    // Create food
    createFood();
    // Call changeDirection whenever a key is pressed
    document.addEventListener("keydown", changeDirection);
    /**
     * Main function of the game
     * called repeatedly to advance the game
     */
    function main() {
        // If the game ended return early to stop game
        if (didGameEnd()) return;
        changeColor();
        setTimeout(function onTick() {
            clearCanvas();
            drawFood();
            advanceSnake();
            drawSnake();
            // Call game again
            main();
        }, speed)
    }

    function changeColor() {
        let snakeColor = document.querySelector("select").value;
        switch (snakeColor) {
            case "green":
                snake_Clr = "lightgreen";
                break;
            case "red":
                snake_Clr = "lightred";
                break;
            case "blue":
                snake_Clr = "lightblue";
                break;
        }
    }
    //Change the background colour of the canvas to canvas_BG_Clr and
    //draw a border around it

    function clearCanvas() {
        //  Select the colour to fill the drawing
        ctx.fillStyle = canvas_BG_Clr;
        //  Select the colour for the border of the canvas
        ctx.strokestyle = canvas_Border_Clr;
        // Draw a "filled" rectangle to cover the entire canvas
        ctx.fillRect(0, 0, gameCanvas.width, gameCanvas.height);
        // Draw a "border" around the entire canvas
        ctx.strokeRect(0, 0, gameCanvas.width, gameCanvas.height);
    }

    // Draw food on canvas

    function drawFood() {
        ctx.fillStyle = food_Clr;
        ctx.strokestyle = food_Border_Clr;
        ctx.fillRect(foodX, foodY, 10, 10);
        ctx.strokeRect(foodX, foodY, 10, 10);
    }
    //Move snake by changing the coordinates
    function advanceSnake() {
        // Create the new Snake's head
        const head = {
            x: snake[0].x + dx,
            y: snake[0].y + dy
        };
        // Add the new head to the beginning of snake body
        snake.unshift(head);
        const didEatFood = snake[0].x === foodX && snake[0].y === foodY;
        if (didEatFood) {
            // score +10
            score += 10;
            document.getElementById('score').innerHTML = score;
            // New food piece
            createFood();
        } else {
            // Remove the last part of snake body
            snake.pop();
        }
    }
    /**
     * Returns true if the head of the snake touched another part of the game
     */
    function didGameEnd() {
        for (let i = 4; i < snake.length; i++) {
            const didCollide = snake[i].x === snake[0].x && snake[i].y === snake[0].y
            if (didCollide) return true
        }
        const hitLeftWall = snake[0].x < 0;
        const hitRightWall = snake[0].x > gameCanvas.width - 10;
        const hitToptWall = snake[0].y < 0;
        const hitBottomWall = snake[0].y > gameCanvas.height - 10;
        return hitLeftWall || hitRightWall || hitToptWall || hitBottomWall
    }

    //Random number to generate x and y coordinates
    function randomTen(min, max) {
        return Math.round((Math.random() * (max - min) + min) / 10) * 10;
    }
    //Snake food on random spot on canvas
    function createFood() {
        // Generate a random number the food x-coordinate
        foodX = randomTen(0, gameCanvas.width - 10);
        // Generate a random number for the food y-coordinate
        foodY = randomTen(0, gameCanvas.height - 10);
        // if the new food location is where the snake currently is, generate a new food location
        snake.forEach(function isFoodOnSnake(part) {
            const foodIsoNsnake = part.x == foodX && part.y == foodY;
            if (foodIsoNsnake) createFood();
        });
    }

    function drawSnake() {
        snake.forEach(drawSnakePart)
    }

    function drawSnakePart(snakePart) {
        // Snake color
        ctx.fillStyle = snake_Clr;
        // Snake border color
        ctx.strokestyle = snake_Border_Clr;
        // Fill snake
        ctx.fillRect(snakePart.x, snakePart.y, 10, 10);
        // Snake border
        ctx.strokeRect(snakePart.x, snakePart.y, 10, 10);
    }

    function changeDirection(event) {
        EDSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSEEEE
        const LEFT_KEY = 37;
        const RIGHT_KEY = 39;
        const UP_KEY = 38;
        const DOWN_KEY = 40;

        const keyPressed = event.keyCode;
        const goingUp = dy === -10;
        const goingDown = dy === 10;
        const goingRight = dx === 10;
        const goingLeft = dx === -10;
        if (keyPressed === LEFT_KEY && !goingRight) {
            dx = -10;
            dy = 0;
        }

        if (keyPressed === UP_KEY && !goingDown) {
            dx = 0;
            dy = -10;
        }

        if (keyPressed === RIGHT_KEY && !goingLeft) {
            dx = 10;
            dy = 0;
        }

        if (keyPressed === DOWN_KEY && !goingUp) {
            dx = 0;
            dy = 10;
        }
    }
</script>

</html>